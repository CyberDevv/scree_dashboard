import tw from 'twin.macro';
import Image from 'next/image';
import { Button, Tooltip } from '@mui/material';

import Logout from '../../public/svg/Iconly.svg';
import { logout } from '../features/userSllice.js';
import { useDispatch } from 'react-redux';
import { useRouter } from 'next/router';
import { signout } from '../firebase/auth.firebase';
import { unload } from '../features/productsSlice';
import Link from 'next/link';

const Dashboard = () => {
   const dispatch = useDispatch();

   const { asPath } = useRouter();

   const { push } = useRouter();

   const handleLogout = () => {
      signout().then((res) => {
         if (res) {
            dispatch(logout());
            dispatch(unload());
            localStorage.removeItem('user');
            push('/login');
         }
      });
   };

   // NavItem Component
   const NavItem = ({ label, icon, link }) => {
      return (
         <li
            tw='pl-6 py-[1.1rem] relative cursor-pointer'
            className={
               asPath === (link || `/${label.toLowerCase()}`)
                  ? 'active'
                  : asPath.includes(`/${label.toLowerCase()}`)
                  ? `active`
                  : tw``
            }
         >
            <Link href={`/${link || label.toLowerCase()}`}>
               <a tw='w-full'>
                  <Tooltip title={label} arrow placement='right'>
                     {icon}
                  </Tooltip>
               </a>
            </Link>
         </li>
      );
   };

   return (
      <MainWrapper>
         <div>
            {/* <Logo /> */}
            <Image src='/svg/logo.svg' alt='Scree' width='86px' height='40' />

            <NavMenu>
               <NavItem
                  link='/'
                  label='Dashboard'
                  icon={
                     <a className='svg'>
                        <svg
                           width='28'
                           height='28'
                           viewBox='0 0 28 28'
                           fill='none'
                           xmlns='http://www.w3.org/2000/svg'
                           style={{ fill: 'inherit' }}
                        >
                           <path
                              fillRule='evenodd'
                              clipRule='evenodd'
                              d='M7.87508 15.75C12.6222 15.75 12.8334 17.36 12.8334 20.7083C12.8334 22.386 12.8334 23.5795 12.1287 24.4533C11.3179 25.4602 9.84208 25.6667 7.87508 25.6667C5.90808 25.6667 4.43225 25.4602 3.62141 24.4533C2.91675 23.5795 2.91675 22.3872 2.91675 20.7375L3.79175 20.7083H2.91675C2.91675 17.36 3.12791 15.75 7.87508 15.75ZM20.7084 15.75C25.4556 15.75 25.6667 17.36 25.6667 20.7083C25.6667 22.386 25.6667 23.5795 24.9621 24.4533C24.1512 25.4602 22.6754 25.6667 20.7084 25.6667C18.7414 25.6667 17.2656 25.4602 16.4547 24.4533C15.7501 23.5795 15.7501 22.3872 15.7501 20.7375L16.6251 20.7083H15.7501C15.7501 17.36 15.9612 15.75 20.7084 15.75ZM8.1156 17.5005L7.87508 17.5C4.83128 17.5 4.67519 17.7184 4.66718 20.2732L4.66767 21.2685C4.6732 22.2847 4.71191 23.0187 4.98291 23.3567C5.29208 23.7393 6.21025 23.9167 7.87508 23.9167C9.53991 23.9167 10.4581 23.7382 10.7672 23.3555C11.0834 22.9623 11.0834 22.029 11.0834 20.7363C11.0834 17.8194 11.0834 17.5142 8.1156 17.5005ZM20.9489 17.5005L20.7084 17.5C17.6646 17.5 17.5085 17.7184 17.5005 20.2732L17.501 21.2685C17.5065 22.2847 17.5452 23.0187 17.8162 23.3567C18.1254 23.7393 19.0436 23.9167 20.7084 23.9167C22.3732 23.9167 23.2914 23.7382 23.6006 23.3555C23.9167 22.9623 23.9167 22.029 23.9167 20.7363C23.9167 17.8194 23.9167 17.5142 20.9489 17.5005ZM7.87508 2.91666C12.6222 2.91666 12.8334 4.52666 12.8334 7.87499C12.8334 9.55266 12.8334 10.7462 12.1287 11.62C11.3179 12.6268 9.84208 12.8333 7.87508 12.8333C5.90808 12.8333 4.43225 12.6268 3.62141 11.62C2.91675 10.7462 2.91675 9.55382 2.91675 7.90416L3.79175 7.87499H2.91675C2.91675 4.52666 3.12791 2.91666 7.87508 2.91666ZM20.7084 2.91666C25.4556 2.91666 25.6667 4.52666 25.6667 7.87499C25.6667 9.55266 25.6667 10.7462 24.9621 11.62C24.1512 12.6268 22.6754 12.8333 20.7084 12.8333C18.7414 12.8333 17.2656 12.6268 16.4547 11.62C15.7501 10.7462 15.7501 9.55382 15.7501 7.90416L16.6251 7.87499H15.7501C15.7501 4.52666 15.9612 2.91666 20.7084 2.91666ZM8.1156 4.66718L7.87508 4.66666C4.83128 4.66666 4.67519 4.88507 4.66718 7.43988L4.66767 8.4352C4.6732 9.45132 4.71191 10.1853 4.98291 10.5233C5.29208 10.906 6.21025 11.0833 7.87508 11.0833C9.53991 11.0833 10.4581 10.9048 10.7672 10.5222C11.0834 10.129 11.0834 9.19566 11.0834 7.90299C11.0834 4.98608 11.0834 4.68091 8.1156 4.66718ZM20.9489 4.66718L20.7084 4.66666C17.6646 4.66666 17.5085 4.88507 17.5005 7.43988L17.501 8.4352C17.5065 9.45132 17.5452 10.1853 17.8162 10.5233C18.1254 10.906 19.0436 11.0833 20.7084 11.0833C22.3732 11.0833 23.2914 10.9048 23.6006 10.5222C23.9167 10.129 23.9167 9.19566 23.9167 7.90299C23.9167 4.98608 23.9167 4.68091 20.9489 4.66718Z'
                           />
                        </svg>
                     </a>
                  }
               />

               {/* products */}
               <NavItem
                  link='/products'
                  label='Products'
                  icon={
                     <a className='svg'>
                        <svg
                           width='28'
                           height='28'
                           viewBox='0 0 28 28'
                           fill='none'
                           xmlns='http://www.w3.org/2000/svg'
                           style={{ fill: 'inherit' }}
                        >
                           <path
                              fillRule='evenodd'
                              clipRule='evenodd'
                              d='M18.5603 2.33334C22.2283 2.33334 24.6923 4.84518 24.6923 8.58318V19.3118C24.6923 23.0825 22.3041 25.5348 18.6081 25.5582L9.63292 25.5617C5.96492 25.5617 3.49976 23.0498 3.49976 19.3118V8.58318C3.49976 4.81134 5.88792 2.36018 9.58392 2.33801L18.5591 2.33334H18.5603ZM18.5603 4.08334L9.58976 4.08801C6.87376 4.10434 5.24976 5.78434 5.24976 8.58318V19.3118C5.24976 22.1293 6.88892 23.8117 9.63176 23.8117L18.6023 23.8082C21.3183 23.7918 22.9423 22.1095 22.9423 19.3118V8.58318C22.9423 5.76568 21.3043 4.08334 18.5603 4.08334ZM18.3352 18.0527C18.8182 18.0527 19.2102 18.4447 19.2102 18.9277C19.2102 19.4107 18.8182 19.8027 18.3352 19.8027H9.91187C9.42887 19.8027 9.03687 19.4107 9.03687 18.9277C9.03687 18.4447 9.42887 18.0527 9.91187 18.0527H18.3352ZM18.3352 13.1684C18.8182 13.1684 19.2102 13.5604 19.2102 14.0434C19.2102 14.5264 18.8182 14.9184 18.3352 14.9184H9.91187C9.42887 14.9184 9.03687 14.5264 9.03687 14.0434C9.03687 13.5604 9.42887 13.1684 9.91187 13.1684H18.3352ZM13.1257 8.29548C13.6087 8.29548 14.0007 8.68748 14.0007 9.17048C14.0007 9.65348 13.6087 10.0455 13.1257 10.0455H9.91152C9.42852 10.0455 9.03652 9.65348 9.03652 9.17048C9.03652 8.68748 9.42852 8.29548 9.91152 8.29548H13.1257Z'
                           />
                        </svg>
                     </a>
                  }
               />

               {/* Collections */}
               <NavItem
                  link='/collections'
                  label='Collections'
                  icon={
                     <a className='svg'>
                        <svg
                           width='28'
                           height='28'
                           viewBox='0 0 28 28'
                           fill='none'
                           xmlns='http://www.w3.org/2000/svg'
                           style={{ fill: 'inherit' }}
                        >
                           <path
                              fillRule='evenodd'
                              clipRule='evenodd'
                              d='M18.5603 2.33334C22.2283 2.33334 24.6923 4.84518 24.6923 8.58318V19.3118C24.6923 23.0825 22.3041 25.5348 18.6081 25.5582L9.63292 25.5617C5.96492 25.5617 3.49976 23.0498 3.49976 19.3118V8.58318C3.49976 4.81134 5.88792 2.36018 9.58392 2.33801L18.5591 2.33334H18.5603ZM18.5603 4.08334L9.58976 4.08801C6.87376 4.10434 5.24976 5.78434 5.24976 8.58318V19.3118C5.24976 22.1293 6.88892 23.8117 9.63176 23.8117L18.6023 23.8082C21.3183 23.7918 22.9423 22.1095 22.9423 19.3118V8.58318C22.9423 5.76568 21.3043 4.08334 18.5603 4.08334ZM18.3352 18.0527C18.8182 18.0527 19.2102 18.4447 19.2102 18.9277C19.2102 19.4107 18.8182 19.8027 18.3352 19.8027H9.91187C9.42887 19.8027 9.03687 19.4107 9.03687 18.9277C9.03687 18.4447 9.42887 18.0527 9.91187 18.0527H18.3352ZM18.3352 13.1684C18.8182 13.1684 19.2102 13.5604 19.2102 14.0434C19.2102 14.5264 18.8182 14.9184 18.3352 14.9184H9.91187C9.42887 14.9184 9.03687 14.5264 9.03687 14.0434C9.03687 13.5604 9.42887 13.1684 9.91187 13.1684H18.3352ZM13.1257 8.29548C13.6087 8.29548 14.0007 8.68748 14.0007 9.17048C14.0007 9.65348 13.6087 10.0455 13.1257 10.0455H9.91152C9.42852 10.0455 9.03652 9.65348 9.03652 9.17048C9.03652 8.68748 9.42852 8.29548 9.91152 8.29548H13.1257Z'
                           />
                        </svg>
                     </a>
                  }
               />

               {/* Notification */}
               <NavItem
                  link=''
                  label='Notifications'
                  icon={
                     <a className='svg'>
                        <svg
                           width='28'
                           height='28'
                           viewBox='0 0 28 28'
                           fill='none'
                           xmlns='http://www.w3.org/2000/svg'
                           style={{ fill: 'inherit' }}
                        >
                           <path
                              fillRule='evenodd'
                              clipRule='evenodd'
                              d='M12.0449 23.457C12.6493 24.1301 13.4251 24.5 14.2301 24.5H14.2313C15.0398 24.5 15.8191 24.1301 16.4246 23.4558C16.7489 23.0976 17.3019 23.0685 17.6601 23.3916C18.0194 23.7148 18.0486 24.269 17.7254 24.6271C16.7828 25.6736 15.5426 26.25 14.2313 26.25H14.2289C12.9211 26.2488 11.6833 25.6725 10.7441 24.626C10.4209 24.2678 10.4501 23.7136 10.8094 23.3916C11.1688 23.0673 11.7218 23.0965 12.0449 23.457ZM14.2882 1.16663C19.474 1.16663 22.9577 5.20563 22.9577 8.97746C22.9577 10.9176 23.4512 11.7401 23.975 12.6128C24.493 13.4738 25.0799 14.4515 25.0799 16.2995C24.6727 21.021 19.7435 21.406 14.2882 21.406C8.83286 21.406 3.90253 21.021 3.50002 16.3741C3.49653 14.4515 4.08336 13.4738 4.60136 12.6128L4.78423 12.305C5.23448 11.5311 5.6187 10.6894 5.6187 8.97746C5.6187 5.20563 9.10236 1.16663 14.2882 1.16663ZM14.2882 2.91663C10.2107 2.91663 7.3687 6.11096 7.3687 8.97746C7.3687 11.403 6.69553 12.5241 6.10053 13.5135C5.62336 14.308 5.24653 14.9356 5.24653 16.2995C5.44136 18.4998 6.89386 19.656 14.2882 19.656C21.6417 19.656 23.1397 18.4485 23.3334 16.2236C23.3299 14.9356 22.953 14.308 22.4759 13.5135C21.8809 12.5241 21.2077 11.403 21.2077 8.97746C21.2077 6.11096 18.3657 2.91663 14.2882 2.91663Z'
                           />
                        </svg>
                     </a>
                  }
               />

               {/* Profile Outdated */}
               {/* <ActiveLink activeClassName='activek' href=''>
                  <Tooltip arrow title='Profile' placement='right'>
                     <a className='svg'>
                        <svg
                           width='28'
                           height='28'
                           viewBox='0 0 28 28'
                           fill='none'
                           xmlns='http://www.w3.org/2000/svg'
                           style={{ fill: 'inherit' }}
                        >
                           <path
                              fillRule='evenodd'
                              clipRule='evenodd'
                              d='M23.1465 21.2253C23.1465 25.0706 17.8732 25.5151 13.9077 25.5151L13.6239 25.5149C11.0974 25.5088 4.6665 25.3493 4.6665 21.202C4.6665 17.4351 9.72792 16.9317 13.6632 16.9127L14.1914 16.9124C16.7178 16.9185 23.1465 17.078 23.1465 21.2253ZM13.9077 18.6621C8.9365 18.6621 6.4165 19.5161 6.4165 21.202C6.4165 22.903 8.9365 23.7651 13.9077 23.7651C18.8777 23.7651 21.3965 22.9111 21.3965 21.2253C21.3965 19.5243 18.8777 18.6621 13.9077 18.6621ZM13.9077 2.33301C17.3237 2.33301 20.1015 5.11201 20.1015 8.52801C20.1015 11.944 17.3237 14.7218 13.9077 14.7218H13.8703C10.4613 14.7113 7.69984 11.9312 7.71147 8.52451C7.71147 5.11201 10.4905 2.33301 13.9077 2.33301ZM13.9077 3.99901C11.4098 3.99901 9.37748 6.03017 9.37748 8.52801C9.36934 11.0177 11.3865 13.0477 13.8738 13.057L13.9077 13.89V13.057C16.4043 13.057 18.4355 11.0247 18.4355 8.52801C18.4355 6.03017 16.4043 3.99901 13.9077 3.99901Z'
                           />
                           placement
                        </svg>
                     </a>
                  </Tooltip>
               </ActiveLink> */}

               {/* settings */}
               <NavItem
                  link='/settings'
                  label='Settings'
                  icon={
                     <a className='svg'>
                        <svg
                           width='28'
                           height='28'
                           viewBox='0 0 28 28'
                           fill='none'
                           xmlns='http://www.w3.org/2000/svg'
                           style={{ fill: 'inherit' }}
                        >
                           <path
                              fillRule='evenodd'
                              clipRule='evenodd'
                              d='M14.9785 1.99988C15.8139 1.99988 16.6259 2.34288 17.208 2.93904C17.789 3.53871 18.1099 4.36121 18.0854 5.19538C18.0877 5.38321 18.1495 5.60021 18.2615 5.79038C18.447 6.10538 18.7399 6.32704 19.0875 6.41804C19.4352 6.50438 19.7992 6.45771 20.1084 6.27454C21.6017 5.42171 23.5022 5.93271 24.355 7.41438L25.0819 8.67321C25.1005 8.70704 25.1169 8.73971 25.1309 8.77354C25.9032 10.233 25.3875 12.0705 23.9525 12.9094C23.7437 13.0295 23.5745 13.1975 23.4579 13.4005C23.277 13.7144 23.2269 14.0877 23.3179 14.4307C23.4112 14.7807 23.634 15.0712 23.9479 15.2509C24.656 15.658 25.1845 16.344 25.3957 17.1362C25.6069 17.9272 25.4914 18.7859 25.0795 19.494L24.3049 20.7844C23.452 22.2497 21.5515 22.7572 20.0734 21.9032C19.8762 21.79 19.6487 21.7282 19.4224 21.7224H19.4154C19.0782 21.7224 18.7317 21.8659 18.4797 22.1167C18.2242 22.3722 18.0842 22.7129 18.0865 23.0745C18.0784 24.7884 16.6842 26.1744 14.9785 26.1744H13.5167C11.8029 26.1744 10.4087 24.7814 10.4087 23.0675C10.4064 22.8564 10.3457 22.637 10.2325 22.4469C10.0494 22.1272 9.75304 21.8985 9.41121 21.8075C9.07171 21.7165 8.69954 21.7667 8.39387 21.944C7.66121 22.3524 6.79904 22.4515 6.01037 22.2299C5.22287 22.007 4.54271 21.4657 4.14371 20.7482L3.41454 19.4917C2.56171 18.0124 3.06921 16.1165 4.54621 15.2625C4.96504 15.021 5.22521 14.5707 5.22521 14.0877C5.22521 13.6047 4.96504 13.1532 4.54621 12.9117C3.06804 12.053 2.56171 10.1525 3.41337 8.67321L4.20437 7.37471C5.04554 5.91171 6.94721 5.39604 8.43004 6.24771C8.63187 6.36788 8.85121 6.42854 9.07404 6.43088C9.80087 6.43088 10.4087 5.83121 10.4204 5.09388C10.4157 4.28071 10.7365 3.50021 11.321 2.91104C11.9079 2.32304 12.6872 1.99988 13.5167 1.99988H14.9785ZM14.9785 3.74988H13.5167C13.155 3.74988 12.8167 3.89104 12.5612 4.14538C12.3069 4.40088 12.168 4.74038 12.1704 5.10204C12.1459 6.80771 10.7517 8.18088 9.06354 8.18088C8.52221 8.17505 8.00071 8.02921 7.54804 7.75854C6.91221 7.39688 6.08154 7.61971 5.70937 8.26721L4.91954 9.56571C4.55787 10.1934 4.77954 11.0229 5.42354 11.3974C6.37904 11.9504 6.97521 12.9817 6.97521 14.0877C6.97521 15.1937 6.37904 16.2239 5.42121 16.778C4.78071 17.149 4.55904 17.9739 4.93004 18.6155L5.66621 19.8849C5.84821 20.2127 6.14571 20.4495 6.48987 20.5464C6.83287 20.642 7.21087 20.6012 7.52587 20.4262C7.98904 20.1544 8.52804 20.0132 9.06937 20.0132C9.33654 20.0132 9.60371 20.047 9.86504 20.117C10.6537 20.3294 11.3385 20.8567 11.7445 21.5649C12.0082 22.0094 12.154 22.5285 12.1587 23.0582C12.1587 23.8165 12.7677 24.4244 13.5167 24.4244H14.9785C15.724 24.4244 16.333 23.82 16.3365 23.0745C16.3319 22.2509 16.6539 21.468 17.243 20.8789C17.824 20.2979 18.636 19.949 19.448 19.9724C19.98 19.9852 20.4922 20.1287 20.9437 20.3854C21.5935 20.7575 22.423 20.5359 22.7987 19.8942L23.5734 18.6027C23.746 18.3052 23.7962 17.9319 23.704 17.5877C23.613 17.2435 23.3844 16.9449 23.0764 16.7687C22.3554 16.3534 21.8409 15.6837 21.6274 14.881C21.4162 14.0935 21.5317 13.2337 21.9435 12.5255C22.2119 12.0589 22.605 11.6657 23.0764 11.395C23.7087 11.0252 23.9304 10.198 23.5629 9.55404C23.5477 9.52838 23.5337 9.50154 23.522 9.47354L22.8384 8.28821C22.4662 7.64071 21.6379 7.41788 20.988 7.78771C20.2857 8.20304 19.4504 8.32204 18.6477 8.11088C17.8462 7.90321 17.1742 7.39571 16.7554 6.67938C16.487 6.23138 16.3412 5.70988 16.3365 5.17904C16.347 4.78004 16.207 4.42188 15.9527 4.15938C15.6995 3.89804 15.3437 3.74988 14.9785 3.74988ZM14.2528 10.1363C16.4309 10.1363 18.2031 11.9097 18.2031 14.0878C18.2031 16.266 16.4309 18.037 14.2528 18.037C12.0746 18.037 10.3024 16.266 10.3024 14.0878C10.3024 11.9097 12.0746 10.1363 14.2528 10.1363ZM14.2528 11.8863C13.0394 11.8863 12.0524 12.8745 12.0524 14.0878C12.0524 15.3012 13.0394 16.287 14.2528 16.287C15.4661 16.287 16.4531 15.3012 16.4531 14.0878C16.4531 12.8745 15.4661 11.8863 14.2528 11.8863Z'
                           />
                        </svg>
                     </a>
                  }
               />
            </NavMenu>
         </div>

         {/* Logout */}
         <Tooltip arrow placement='right' title='Logout'>
            <LogoutWrapper onClick={handleLogout}>
               <Logout />
            </LogoutWrapper>
         </Tooltip>
      </MainWrapper>
   );
};

// Tailwind Styles
const MainWrapper = tw.div`fixed bg-primary-darkest h-[calc(100vh - 52px)] text-white flex flex-col justify-between rounded-[32px] pl-5 py-14 min-w-[120px] w-[120px] overflow-x-hidden`;
const NavMenu = tw.ul`mt-8`;
const LogoutWrapper = tw.button`pl-6 py-[1.1rem] relative`;

export default Dashboard;
